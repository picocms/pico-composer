### Rewrite Rules Added by CyberPanel Rewrite Rule Generator

RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.(.*)$
RewriteRule ^(.*)$ https://%1/$1 [L,R=301]

### End CyberPanel Generated Rules.

RewriteEngine On

# Deals with trailing slash
RewriteRule ^(.+)/$ $1 [L,R=301]

# Deny access to internal dirs and files by passing the URL to Pico
RewriteRule ^(config|content|vendor|CHANGELOG\.md|composer\.(json|lock|phar))(/|$) index.php [L]
RewriteRule (^\.|/\.)(?!well-known(/|$)) index.php [L]

# Enable URL rewriting
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [L]

RewriteRule ^test/.*$ - [F,L] # Prevent file browsing

# Controlling Access to Files
RewriteRule ^/.*\.(log|ini)$ - [F,L] # Deny access to .ini and .log files
RewriteRule xmlpc.php$ - [F,L] # Deny access to xmlpc.php file